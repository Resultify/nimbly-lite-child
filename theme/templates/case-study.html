<!--
  templateType: page
  label: Case study template
  isAvailableForNewContent: true
  enableDomainStylesheets: false
  screenshotPath: ../images/template-previews/case-study.jpg
-->
{% set template_css = '../../css/templates/case-study.css' %}
{% extends "./layouts/base.html" %}

{% block body %}

  {% if html_lang == "sv" %}
    {% set website = 'Webbplats' %}
    {% set related_case_studies = 'Relaterade fallstudier' %}
  {% elif html_lang == "da" %}
    {% set website = 'Hjemmeside' %}
    {% set related_case_studies = 'Relaterede casestudier' %}
  {% else %}
    {% set website = 'Website' %}
    {% set related_case_studies = 'Related case studies' %}
  {% endif %}

  {% if dynamic_page_hubdb_row %}
    {# Create settings #}
    {% set settings = {} %}

    <div class="case-study-template">

      <div class="case-study_wrp">

        {# Header - includes company logo and title #}
        <div class="case-study__header">
          {% if dynamic_page_hubdb_row.company_logo %}
            <div class="case-study__company-logo-wrp">
              <img class="case-study__company-logo"
                src="{{dynamic_page_hubdb_row.company_logo.url}}"
                alt="{{dynamic_page_hubdb_row.company_logo.altText}}"
                width="{{dynamic_page_hubdb_row.company_logo.width}}"
                height="{{dynamic_page_hubdb_row.company_logo.height}}"
                srcset="{{ resize_image_url(dynamic_page_hubdb_row.company_logo.url, 0, 0, 1024) }}"
              >
            </div>
          {% endif %}

          {% if dynamic_page_hubdb_row.title %}
            <h1 class="case-study__title">
              {{dynamic_page_hubdb_row.title}}
            </h1>
          {% endif %}
        </div>

        <article class="case-study__article">

          {# Summary - includes Featured Image, Industry, Challenge, Results, Key Products, Company Website #}
          <div class="case-study__summary">

            {% if dynamic_page_hubdb_row.summary_featured_image %}
              <div class="case-study__summary-featured-image-wrp">
                <img class="case-study__summary-featured-image"
                  src="{{dynamic_page_hubdb_row.summary_featured_image.url}}"
                  alt="{{dynamic_page_hubdb_row.summary_featured_image.altText}}"
                  width="{{dynamic_page_hubdb_row.summary_featured_image.width}}"
                  height="{{dynamic_page_hubdb_row.summary_featured_image.height}}"
                  srcset="{{ resize_image_url(dynamic_page_hubdb_row.summary_featured_image.url, 0, 0, 1024) }}"
                >
              </div>
            {% endif %}

            <div class="case-study__summary-content">
              {# Industry #}
              {% if dynamic_page_hubdb_row.summary_industry %}
                <div class="case-study__summary-industry">

                  {% if dynamic_page_hubdb_row.summary_industry_label %}
                    <h6 class="case-study__summary-industry-label">
                      {{dynamic_page_hubdb_row.summary_industry_label}}
                    </h6>
                  {% endif %}
                  {{ dynamic_page_hubdb_row.summary_industry.label }}
                </div>
              {% endif %}

              {# Challenge #}
              {% if dynamic_page_hubdb_row.summary_challenge %}
                <div class="case-study__summary-challenge">
                  {% if dynamic_page_hubdb_row.summary_challenge_summary_label %}
                    <h6 class="case-study__summary-challenge-label">
                      {{dynamic_page_hubdb_row.summary_challenge_summary_label}}
                    </h6>
                  {% endif %}
                  {{dynamic_page_hubdb_row.summary_challenge}}
                </div>
              {% endif %}

              {# Results #}
              {% if dynamic_page_hubdb_row.summary_results %}
                <div class="case-study__summary-results">
                  {% if dynamic_page_hubdb_row.summary_results_label %}
                    <h6 class="case-study__summary-results-label">
                      {{dynamic_page_hubdb_row.summary_results_label}}
                    </h6>
                  {% endif %}
                  {{dynamic_page_hubdb_row.summary_results}}
                </div>
              {% endif %}

              {# Key Products #}
              {% if dynamic_page_hubdb_row.summary_key_products %}
                <div class="case-study__summary-key-products">
                  {% if dynamic_page_hubdb_row.summary_key_products_label %}
                    <h6 class="case-study__summary-key-products-label">
                      {{dynamic_page_hubdb_row.summary_key_products_label}}
                    </h6>
                  {% endif %}

                  {% for product in dynamic_page_hubdb_row.summary_key_products %}
                    <span class="case-study__summary-key-product">{{ product.label }}</span>
                  {% endfor %}
                </div>
              {% endif %}

              {# Company website #}
              {% if dynamic_page_hubdb_row.summary_company_website %}
                <div class="case-study__summary-company-website">
                  <h6 class="case-study__summary-company-website-label">{{ website }}</h6>
                  <a href="{{dynamic_page_hubdb_row.summary_company_website}}" target="_blank" rel="noopener">
                    {{dynamic_page_hubdb_row.summary_company_website}}
                  </a>
                </div>
              {% endif %}
            </div>

          </div>

          {% if dynamic_page_hubdb_row.success_metrics %}
            <div class="case-study__success-metrics">
              <div class="case-study__success-metrics-container">
                {% for metric in dynamic_page_hubdb_row.success_metrics %}
                  <div class="case-study__success-metric-item">
                    <div class="case-study__success-metric-value">{{ metric.value }}</div>
                    <div class="case-study__success-metric-name">{{ metric.name }}</div>
                  </div>
                {% endfor %}
              </div>
            </div>
          {% endif %}

          {# Testimonial - includes author image, name, role and quote #}
          {% if dynamic_page_hubdb_row.testimonial_quote %}
            <div class="case-study__testimonial-wrp">
              <blockquote class="case-study__testimonial-quote">
                {{dynamic_page_hubdb_row.testimonial_quote}}
              </blockquote>

              <div class="case-study__testimonial-author">

                {% if dynamic_page_hubdb_row.testimonial_author_image %}
                  <div class="case-study__testimonial-author-image-wrp">
                    <img class="case-study__testimonial-author-image"
                      src="{{dynamic_page_hubdb_row.testimonial_author_image.url}}"
                      alt="{{dynamic_page_hubdb_row.testimonial_author_image.altText}}"
                      width="{{dynamic_page_hubdb_row.testimonial_author_image.width}}"
                      height="{{dynamic_page_hubdb_row.testimonial_author_image.height}}"
                      srcset="{{ resize_image_url(dynamic_page_hubdb_row.testimonial_author_image.url, 0, 0, 1024) }}">
                  </div>
                {% endif %}

                <div class="case-study__testimonial-author-info">
                  {% if dynamic_page_hubdb_row.testimonial_author_name %}
                    <div class="case-study__testimonial-author-name">
                      {{dynamic_page_hubdb_row.testimonial_author_name}}
                    </div>
                  {% endif %}

                  {% if dynamic_page_hubdb_row.testimonial_author_role %}
                    <div class="case-study__testimonial-author-role">
                      {{dynamic_page_hubdb_row.testimonial_author_role}}
                    </div>
                  {% endif %}
                </div>
              </div>
            </div>
          {% endif %}

          {# Company summary - includes image, name and summary #}
          {% if dynamic_page_hubdb_row.company_summary %}
            <div class="case-study__company-summary">
              {% if dynamic_page_hubdb_row.company_image %}
                <div class="case-study__company-image-wrp">
                  <img class="case-study__company-image"
                    src="{{dynamic_page_hubdb_row.company_image.url}}"
                    alt="{{dynamic_page_hubdb_row.company_image.altText}}"
                    width="{{dynamic_page_hubdb_row.company_image.width}}"
                    height="{{dynamic_page_hubdb_row.company_image.height}}"
                    srcset="{{ resize_image_url(dynamic_page_hubdb_row.company_image.url, 0, 0, 1024) }}"
                  >
                </div>
              {% endif %}

              {% if dynamic_page_hubdb_row.company_name %}
                <h2 class="case-study__company-name">
                  {{dynamic_page_hubdb_row.company_name}}
                </h2>
              {% endif %}

              <div class="case-study__company-summary-text">
                {{dynamic_page_hubdb_row.company_summary}}
              </div>
            </div>
          {% endif %}

          {% if dynamic_page_hubdb_row.case_study_body %}
            <div class="case-study__body" style="border: 10px solid orange;">
              {{dynamic_page_hubdb_row.case_study_body}}
            </div>
          {% endif %}
        </article>

        {# Related Case Studies - same industry #}
        {% if dynamic_page_hubdb_row.summary_industry %}
          {% set current_industry = dynamic_page_hubdb_row.summary_industry %}
          {% set current_row_id = dynamic_page_hubdb_row.hs_id %}
          {% set related_cases = hubdb_table_rows(dynamic_page_hubdb_table_id, "summary_industry=" ~ current_industry.name) %}

          {% set filtered_cases = [] %}
          {% for case in related_cases %}
            {% if case.hs_id != current_row_id and not case.hide %}
              {% do filtered_cases.append(case) %}
              {% if filtered_cases|length >= 3 %}
                {% break %}
              {% endif %}
            {% endif %}
          {% endfor %}

          {% if filtered_cases|length > 0 %}
            <div class="case-study__related-case-studies">
              <h2 class="case-study__related-case-studies-title">{{ related_case_studies }}</h2>
              <div class="case-study__related-case-studies-container">
                {% for case in filtered_cases %}
                  <a href="{{ '/' ~ content.slug ~ '/' ~ case.hs_path }}" class="case-study__related-case-study-item">

                    {% if case.company_logo %}
                      <img class="case-study__related-case-study-company-logo"
                        src="{{case.company_logo.url}}"
                        alt="{{case.company_logo.altText}}"
                        width="{{case.company_logo.width}}"
                        height="{{case.company_logo.height}}"
                        srcset="{{ resize_image_url(case.company_logo.url, 0, 0, 500) }}">
                    {% endif %}

                    {% if case.summary_industry %}
                      <span class="case-study__related-case-study-industry">{{ case.summary_industry.label }}</span>
                    {% endif %}

                    <h3>{{ case.title }}</h3>

                  </a>
                {% endfor %}
              </ul>
            </div>

          {% endif %}
        {% endif %}
      </div>
    </div>

  {% elif dynamic_page_hubdb_table_id %}
    {% dnd_area 'dnd_area'
      label='Case study template',
      class='case-study-template'
    %}
      {% dnd_section %}
        {% dnd_column
          offset=0,
          width=12
        %}
          {% dnd_row %}
            {#{% dnd_module
              path="../modules/case-study-list",
              offset=0,
              width=12,
            %}
            {% end_dnd_module %}#}
          {% end_dnd_row %}
        {% end_dnd_column %}
      {% end_dnd_section %}
    {% end_dnd_area %}
  {% endif %}
{% endblock body %}
