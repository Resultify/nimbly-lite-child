<!--
  templateType: "none"
  isAvailableForNewContent: false
-->

{%- macro render(module, global) -%}
  {%- if module.lottie_file -%}
    {{require_js(get_asset_url('../assets/js/dotlottie.js'), {defer: true})}}
    {% require_js %}
      <script>
        function runDotLottie () {
          const dotLottieCanvas = document.getElementsByClassName('dotlottie-canvas')
          if (!dotLottieCanvas) return
          for (const item of dotLottieCanvas) {
            const dotLottie = new window.DotLottie({ // eslint-disable-line
              autoplay: true,
              loop: item.hasAttribute('data-loop'),
              speed: item.dataset.speed,
              mode: item.dataset.mode,
              layout: {
                fit: item.dataset.fit,
                align: item.dataset.align.split(',')
              },
              canvas: item,
              src: item.dataset.lottieSrc
            })
            dotLottie.setLayout({ align: [0, 0.5] })
          }
        }
        if (document.readyState === 'loading') {
          document.addEventListener('DOMContentLoaded', runDotLottie)
        } else {
          runDotLottie()
        }
      </script>
    {% end_require_js %}
    {% if global.style.general.alignment.horizontal_align == 'LEFT' %}
      {% set lottie_alignment = '0,0.5' %}
    {% elif global.style.general.alignment.horizontal_align == 'CENTER' %}
      {% set lottie_alignment = '0.5,0.5' %}
    {% elif global.style.general.alignment.horizontal_align == 'RIGHT' %}
      {% set lottie_alignment = '1,0.5' %}
    {% endif %}
    <canvas class="lottie-macro dotlottie-canvas"
      data-lottie-src="{{module.lottie_file}}"
      data-speed="{{module.lottie_speed}}"
      data-mode="{{module.lottie_mode}}"
      data-fit="{{module.lottie_fit}}"
      data-align="{{lottie_alignment}}"
      {{"data-loop" if module.lottie_loop}}
      >
    </canvas>
  {%- endif -%}
{%- endmacro -%}
